var tretoLocalizationTable = { "ru_RU": {
  
  // auth
  "not authorized": "Вы не авторизованы. Попробуйте войти в систему заново.",
  "Access Denied": "Это действие для вас заблокировано. Попробуйте зайти в систему заново или обратиться к администратору.",
  "User account is disabled.": "Ваш аккаунт заблокирован.",
  "Bad credentials": "Пользователя с такими данными не найдено. Возможно, введён неверный пароль.",
  "Captcha is invalid": "Каптча не пройдена.",
  //resetting
  "Wrong username": "Указан несуществующий пользователь.",
  "Failed to generate token": "Ошибка при отправлении кода подтверждения. Возможно, в профиле указан некорректный телефон. Обратитесь к администратору.",
  "Wrong token": "Неправильный код подтверждения.",
  "Error changing password": "Ошибка при смене пароля.",
  "Expired token": "Код подтверждения устарел.",
  
  // tasks
  "task.history.perf": "Изменение исполнителя",
  "task.history.reject": "Возвращена на доработку",
  "task.history.const": "Lotus",
  "task.history.dif": "Изменение сложности",
  "task.history.cancel": "Отмена просьбы",
  "task.history.notify": "Уведомление о выполнении",
  "task.history.close": "Просьба закрыта",
  "task.history.real": "Подтвержденный срок",
  "task.history.C1": "Категория",
  "task.history.status": "Статус",
  "task.history.taskDateStart": "Установленная дата начала",
  "task.history.taskDateEnd": "Установленная дата выполнения",
  "task.history.Priority": "Приоритет",
  "task.history.taskPerformerLat": "Исполнитель",
  "task.history.Difficulty": "Сложность",
  "task.history.taskDateRealStart": "Подтверждённая дата начала",
  "task.history.taskDateRealEnd": "Подтвеждённая дата выполнения",
  "task.history.taskDateCompleted": "Фактическая дата выполнения",
  "task.history.CheckerLat": "Отправлена на проверку",
  "task.history.check": "Отправлена на проверку",
  "task.open": "Открыта",
  "task.close": "Закрыта",
  "task.cancelled": "Отменена",
  "task.deleted": "Удалена",
  "task.completed": "Выполнена",
  "task.incomplete": "Не выполнена",
  "task.notAccepted": "Не принята",
  "task.overdue": "Просрочена",
  "task.suspended": "Подвешена",
  "task.": "(значение снято)",
  "tasks": "Просьбы",
    
  // Contacts
  "Contacts": "Контакты",
  "contacts.removed": "Контакт удалён",
  "contacts.undeleted": "Контакт восстановлен",
  "search.group": "Группы",
  "search.phone": "Телефоны",
  "search.email": "Эл.почты",
  "search.site": "Вебсайты",
  "search.subject": "Тема",
  "search.viewbody": "Тело",
  "search.bodyweb": "Тело",
  "search.body": "Тело",
  "search.status": "Статус",
  "search.boss": "Руководитель",
  "search.action": "Действие",
  "search.authorrus": "Автор",
  
  // adaptation
  "Adaptation": "Адаптационный лист",
  "adaptation.task.HeadIT.subject": "DNS на сайт для \"%FullNameInRus%\"",
  "adaptation.task.ManagerHR.subject": "Оформить нового сотрудника \"%FullNameInRus%\"",
  "adaptation.task.Author.subject": "Заполнить контакт \"%FullNameInRus%\"",
  "adaptation.task.HeadIT.body": "Новый сотрудник %FullNameInRus% принят на работу на должность %WorkGroup%. Нужно cоздать прямой адрес для обращений с сайта в коммуникатор. Логин указан в адаптационном листе.",
  "adaptation.task.ManagerHR.body": "Новый сотрудник %FullNameInRus% принят на работу на должность %WorkGroup%. Нужно оформить все документы.",
  "adaptation.task.Author.body": "Внести резюме и хит-лист в личную карточку нового сотрудника %FullNameInRus%.",
  "adaptation.task.Login.body": "Загрузить фото в свой профиль на портале, заполнить поле с номером телефона.",
  "adaptation.task.Login.subject": "Загрузить фото в свой профиль на портале, заполнить поле с номером телефона.",
  "adaptation.task.Sysadmin.body": "Создать почту для нового сотрудника \"%FullNameInRus%\".",
  "adaptation.task.Sysadmin.subject": "Создать почту для нового сотрудника \"%FullNameInRus%\".",
  "adaptation.task.Teamlead.subject": "Добавить в чат \"%FullNameInRus%\".",
  "adaptation.task.Teamlead.body": "Добавить в чат \"%FullNameInRus%\".",
  "createUserFromAdaptation: username duplicate": "Невозможно создать пользователя: такой логин уже существует.",
  "createUserFromAdaptation: fullname duplicate": "Невозможно создать пользователя: уже есть пользовател с такими ФИО.",
  "createUserFromAdaptation: email duplicate": "Невозможно создать пользователя: такой Email уже существует.",
  
  // attachments
  "attachments.getlink": "Получить ссылку",
  "attachments.insertLink": "Вставить ссылку в сообщение",
  "attachments.insertThumbnail": "Вставить изображение в сообщение",
  "attachments.insertAnswerThumbnail": "Вставить изображение в вариант ответа",
  "attachments.insertFullsize": "Вставить изображение исходных размеров",
  "attachments.rightAlign": "Вставить изображение справа от текста",
  "attachments.insertFullsizeShort": "Оригинал",
  "attachments.rightAlignShort": "Справа",
  "attachments.download": "Скачать",
  "attachments.list": "Прикреплённые файлы",
  "attachments.delete": "Удалить файл",
  "attachments.help.upload": "Выберите один или несколько файлов, нажав на кнопку \"Обзор\" или переместив их в пунктирную область.",
  
  // Discus
  "Discus": "Обсуждения",
  "Voting": "Опрос",
  "voting.limitReached": "Выбрано слишком много ответов. Можно выбрать не более %AnswersLim% ответов.",
  "voting.abandonConfirm": "Вы действительно хотите отказаться от голосования и увидеть результаты? Участие в этом опросе будет невозможно.",
  "discus.noDiscusInstance": "Отсутствует экземпляр объекта обсуждений (некуда отвечать). Попробуйте найти обсуждение заново.",
  "discus.participants.duplicate": "Субъект уже находится в участниках",
  "discus.emptySection": "В выбранном отделе нет действующих сотрудников",
  "discus.ioNotifyUsersFailed": "Серверу не удалось уведомить %count% участников о новостях в этом обсуждении. \nПодробности: \n%details%",
  "discus.progress.requesting data": "Запрос данных с сервера ...",
  "discus.progress.preparing documents": "Подготовка документов ...",
  "discus.progress.finishing": "Завершение обработки ...",
  "discus.wrongTaskid": "Целевая просьба не найдена. Попробуйте обновить страницу и повторить операцию.",
  "discus.header.title.placeholder.formTask": "Название просьбы",
  "discus.header.title.placeholder.formProcess": "Название темы",
  "discus.header.title.placeholder.formVoting": "Тема опроса",
  "discus.header.title.placeholder.message": "Заголовок сообщения (не обязательно)",
  "discus.header.title.placeholder.messagebb": "Заголовок сообщения (не обязательно)",
  
  // Dictionary
  "Dictionary": "Словари",
  "dictionaryPrototype": "Прототип словаря",
  "dictionary.saved": "Словарь успешно сохранён!",
  "no dictionary of such type found": "Словарь указанного типа не найден.",
  "no records specified": "Не указано ни одной записи для изменения.",
  "document must contain privileges": "Записи не содержат информации о правах доступа. Возможно, они устарели или неверны. Попробуйте обратиться к администратору.",
  
  // SEO
  "seo.title": "SEO заголовок для продвижения",
  "seo.description": "SEO описание для продвижения",
  "seo.keywords": "SEO ключевые слова для продвижения (обычно не более 10)",
  
  // Treto Date
  "date.tooltip.datetime": "Выбор даты и времени",
  "date.tooltip.date": "Выбор даты",
  "date.tooltip.day": "День",
  "date.tooltip.month": "Месяц",
  "date.tooltip.year": "Год",
  "date.tooltip.hours": "Часы",
  "date.tooltip.minutes": "Минуты",
  "date.tooltip.seconds": "Секунды",
  "date.h": "ч.",
  "date.min": "мин.",
  "date.sec": "сек.",
  
  // misc.
  "Top Person": "Люди месяца",
  "empty query": "На сервер переданы неверные входные данные. Если это вызвано обычной работой с порталом, обратитесь к разработчикам.",
  "Favorites": "Избранное",
  "BatchHttp": "Пакетный HTTP запрос",
  "HTTP Response failed": "Ошибка HTTP ответа %status%",
  "parent document not found or access denied": "Главный документ обсуждения не найден или у вас нет прав на открытие этого документа. Попробуйте обратиться к автору документа.",
  "document not found": "Документ не найден. Возможно, он был удалён или ссылка неверна.",
  "wrong input": "На сервер переданы неверные входные данные. Если это вызвано обычной работой с порталом, обратитесь к разработчикам.",
  "the document is marked as deleted": "Документ был помечен на удаление и данная ссылка теперь недоступна.",
  "permission denied": "У вас недостаточно прав на совершение этого действия. Попробуйте обратиться к автору документа.",
  "user already voted": "Вы уже проголосовали в этом опросе.",
  "no documents with specified subjects found": "С указанными идентификаторами не найдено ни одного документа.",
  "not found": "Не найдено",
  "no section specified": "Не был указан Отдел для поиска. Возможно, он неисправен. Попробуйте обратиться к администратору.",
  "parameter unid not found": "Не найден UNID заданного документа. Возможно, он неисправен. Попробуйте обратиться к администратору.",
  "users not found": "По заданным критериям не найдено ни одного пользователя.",
  "users not found by fullname": "Невозможно найти пользователя по заданному имени. Возможно, передана неверная ссылка.",
  "DevInfo": "Информация для разработчиков",
  
  // END
  "_": null
},
"nl":{"link": "link"},
"pl":{"link": "link"},
"fr":{"link": "référence"},
"it":{"link": "indirizzo della pagina"},
"de":{"link": "link"},
"es":{"link": "link"},
"fi":{"link": "linkki"},
"ru":{"link": "ссылка"},
"en":{"link": "link"}
};

var tretoLocalizeReplace = function(src, params) {
  if(!params || params.isEmpty()) { return src; }
  var result = src.replace(/\%([\da-zA-Z\-\_]+)\%/g, function(s, key) {
   return params[key] || s;
  });
  return result;
}
var tretoLocalize = function(s,prefix,objectParams,lang) {
  if(! s) { return s; }
  if(prefix) { prefix = prefix+'.'; } else { prefix = ''; }
  return tretoLocalizeReplace(tretoLocalizationTable[lang || 'ru_RU'][prefix+s] || s, objectParams);
};

portalApp.filter('localize', function() { return tretoLocalize; });
portalApp.factory('localize', function() { return tretoLocalize; });

var tretoTransliterationTable = { 'ru_RU': {
  'А': 'A', 'а': 'a',
  'Б': 'B', 'б': 'b',
  'В': 'V', 'в': 'v',
  'Г': 'G', 'г': 'g',
  'Д': 'D', 'д': 'd',
  'Е': 'E', 'е': 'e',
  'Ё': 'Yo', 'ё': 'yo',
  'Ж': 'Zh', 'ж': 'zh',
  'З': 'Z', 'з': 'z',
  'И': 'I', 'и': 'i',
  'Й': 'Y', 'й': 'y',
  'К': 'K', 'к': 'k',
  'Л': 'L', 'л': 'l',
  'М': 'M', 'м': 'm',
  'Н': 'N', 'н': 'n',
  'О': 'O', 'о': 'o',
  'П': 'P', 'п': 'p',
  'Р': 'R', 'р': 'r',
  'С': 'S', 'с': 's',
  'Т': 'T', 'т': 't',
  'У': 'U', 'у': 'u',
  'Ф': 'F', 'ф': 'f',
  'Х': 'H', 'х': 'h',
  'Ц': 'Ts', 'ц': 'ts',
  'Ч': 'Ch', 'ч': 'ch',
  'Ш': 'Sh', 'ш': 'sh',
  'Щ': 'Shch', 'щ': 'shch',
  'Ъ': '', 'ъ': '',
  'Ы': 'Uyi', 'ы': 'uyi',
  'Ь': '', 'ь': '',
  'Э': 'E', 'э': 'e',
  'Ю': 'Yu', 'ю': 'yu',
  'Я': 'Ya', 'я': 'ya'
  
} };

var tretoTranslit = function(text,lang) {
  if(! text) { return ''; }
  var transl = tretoTransliterationTable[lang || 'ru_RU'];
  var result='';
  for(i=0;i<text.length;i++) {
      if(transl[text[i]]!=undefined) { result+=transl[text[i]]; }
      else { result+=text[i]; }
  }
  return result;
};

portalApp.filter('translit', function() { return tretoTranslit; });
portalApp.factory('translit', function() { return tretoTranslit; });
